{"cells":[{"cell_type":"code","source":["from google.colab import drive\n","drive.mount('/content/drive')"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"dBjI4ZTiQx-i","executionInfo":{"status":"ok","timestamp":1763292200180,"user_tz":-210,"elapsed":22483,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"}},"outputId":"6a76c785-50a9-4267-d013-165d6669c57e","collapsed":true},"execution_count":1,"outputs":[{"output_type":"stream","name":"stdout","text":["Mounted at /content/drive\n"]}]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":9962,"status":"ok","timestamp":1763288390395,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"},"user_tz":-210},"id":"HUWFa2ocTro8","outputId":"bd6d5164-8203-419f-b24b-cd720ac3b303","collapsed":true},"outputs":[{"output_type":"stream","name":"stdout","text":["Requirement already satisfied: dill in /usr/local/lib/python3.12/dist-packages (0.3.8)\n","Collecting jupyterlab\n","  Downloading jupyterlab-4.4.10-py3-none-any.whl.metadata (16 kB)\n","Requirement already satisfied: ipywidgets in /usr/local/lib/python3.12/dist-packages (7.7.1)\n","Requirement already satisfied: tqdm in /usr/local/lib/python3.12/dist-packages (4.67.1)\n","Collecting fire\n","  Downloading fire-0.7.1-py3-none-any.whl.metadata (5.8 kB)\n","Requirement already satisfied: seaborn in /usr/local/lib/python3.12/dist-packages (0.13.2)\n","Collecting palettable\n","  Downloading palettable-3.3.3-py2.py3-none-any.whl.metadata (3.3 kB)\n","Requirement already satisfied: wandb in /usr/local/lib/python3.12/dist-packages (0.22.3)\n","Requirement already satisfied: numpy in /usr/local/lib/python3.12/dist-packages (2.0.2)\n","Requirement already satisfied: scipy in /usr/local/lib/python3.12/dist-packages (1.16.3)\n","Requirement already satisfied: pandas in /usr/local/lib/python3.12/dist-packages (2.2.2)\n","Requirement already satisfied: scikit-learn in /usr/local/lib/python3.12/dist-packages (1.6.1)\n","Requirement already satisfied: timm in /usr/local/lib/python3.12/dist-packages (1.0.22)\n","Collecting async-lru>=1.0.0 (from jupyterlab)\n","  Downloading async_lru-2.0.5-py3-none-any.whl.metadata (4.5 kB)\n","Requirement already satisfied: httpx<1,>=0.25.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (0.28.1)\n","Requirement already satisfied: ipykernel!=6.30.0,>=6.5.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (6.17.1)\n","Requirement already satisfied: jinja2>=3.0.3 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (3.1.6)\n","Requirement already satisfied: jupyter-core in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (5.9.1)\n","Collecting jupyter-lsp>=2.0.0 (from jupyterlab)\n","  Downloading jupyter_lsp-2.3.0-py3-none-any.whl.metadata (1.8 kB)\n","Requirement already satisfied: jupyter-server<3,>=2.4.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (2.14.0)\n","Collecting jupyterlab-server<3,>=2.27.1 (from jupyterlab)\n","  Downloading jupyterlab_server-2.28.0-py3-none-any.whl.metadata (5.9 kB)\n","Requirement already satisfied: notebook-shim>=0.2 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (0.2.4)\n","Requirement already satisfied: packaging in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (25.0)\n","Requirement already satisfied: setuptools>=41.1.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (75.2.0)\n","Requirement already satisfied: tornado>=6.2.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (6.5.1)\n","Requirement already satisfied: traitlets in /usr/local/lib/python3.12/dist-packages (from jupyterlab) (5.7.1)\n","Requirement already satisfied: ipython-genutils~=0.2.0 in /usr/local/lib/python3.12/dist-packages (from ipywidgets) (0.2.0)\n","Requirement already satisfied: widgetsnbextension~=3.6.0 in /usr/local/lib/python3.12/dist-packages (from ipywidgets) (3.6.10)\n","Requirement already satisfied: ipython>=4.0.0 in /usr/local/lib/python3.12/dist-packages (from ipywidgets) (7.34.0)\n","Requirement already satisfied: jupyterlab-widgets>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from ipywidgets) (3.0.16)\n","Requirement already satisfied: termcolor in /usr/local/lib/python3.12/dist-packages (from fire) (3.2.0)\n","Requirement already satisfied: matplotlib!=3.6.1,>=3.4 in /usr/local/lib/python3.12/dist-packages (from seaborn) (3.10.0)\n","Requirement already satisfied: click>=8.0.1 in /usr/local/lib/python3.12/dist-packages (from wandb) (8.3.0)\n","Requirement already satisfied: gitpython!=3.1.29,>=1.0.0 in /usr/local/lib/python3.12/dist-packages (from wandb) (3.1.45)\n","Requirement already satisfied: platformdirs in /usr/local/lib/python3.12/dist-packages (from wandb) (4.5.0)\n","Requirement already satisfied: protobuf!=4.21.0,!=5.28.0,<7,>=3.19.0 in /usr/local/lib/python3.12/dist-packages (from wandb) (5.29.5)\n","Requirement already satisfied: pydantic<3 in /usr/local/lib/python3.12/dist-packages (from wandb) (2.11.10)\n","Requirement already satisfied: pyyaml in /usr/local/lib/python3.12/dist-packages (from wandb) (6.0.3)\n","Requirement already satisfied: requests<3,>=2.0.0 in /usr/local/lib/python3.12/dist-packages (from wandb) (2.32.4)\n","Requirement already satisfied: sentry-sdk>=2.0.0 in /usr/local/lib/python3.12/dist-packages (from wandb) (2.44.0)\n","Requirement already satisfied: typing-extensions<5,>=4.8 in /usr/local/lib/python3.12/dist-packages (from wandb) (4.15.0)\n","Requirement already satisfied: python-dateutil>=2.8.2 in /usr/local/lib/python3.12/dist-packages (from pandas) (2.9.0.post0)\n","Requirement already satisfied: pytz>=2020.1 in /usr/local/lib/python3.12/dist-packages (from pandas) (2025.2)\n","Requirement already satisfied: tzdata>=2022.7 in /usr/local/lib/python3.12/dist-packages (from pandas) (2025.2)\n","Requirement already satisfied: joblib>=1.2.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn) (1.5.2)\n","Requirement already satisfied: threadpoolctl>=3.1.0 in /usr/local/lib/python3.12/dist-packages (from scikit-learn) (3.6.0)\n","Requirement already satisfied: torch in /usr/local/lib/python3.12/dist-packages (from timm) (2.8.0+cu126)\n","Requirement already satisfied: torchvision in /usr/local/lib/python3.12/dist-packages (from timm) (0.23.0+cu126)\n","Requirement already satisfied: huggingface_hub in /usr/local/lib/python3.12/dist-packages (from timm) (0.36.0)\n","Requirement already satisfied: safetensors in /usr/local/lib/python3.12/dist-packages (from timm) (0.6.2)\n","Requirement already satisfied: gitdb<5,>=4.0.1 in /usr/local/lib/python3.12/dist-packages (from gitpython!=3.1.29,>=1.0.0->wandb) (4.0.12)\n","Requirement already satisfied: anyio in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.25.0->jupyterlab) (4.11.0)\n","Requirement already satisfied: certifi in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.25.0->jupyterlab) (2025.10.5)\n","Requirement already satisfied: httpcore==1.* in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.25.0->jupyterlab) (1.0.9)\n","Requirement already satisfied: idna in /usr/local/lib/python3.12/dist-packages (from httpx<1,>=0.25.0->jupyterlab) (3.11)\n","Requirement already satisfied: h11>=0.16 in /usr/local/lib/python3.12/dist-packages (from httpcore==1.*->httpx<1,>=0.25.0->jupyterlab) (0.16.0)\n","Requirement already satisfied: debugpy>=1.0 in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (1.8.15)\n","Requirement already satisfied: jupyter-client>=6.1.12 in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (7.4.9)\n","Requirement already satisfied: matplotlib-inline>=0.1 in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (0.2.1)\n","Requirement already satisfied: nest-asyncio in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (1.6.0)\n","Requirement already satisfied: psutil in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (5.9.5)\n","Requirement already satisfied: pyzmq>=17 in /usr/local/lib/python3.12/dist-packages (from ipykernel!=6.30.0,>=6.5.0->jupyterlab) (26.2.1)\n","Collecting jedi>=0.16 (from ipython>=4.0.0->ipywidgets)\n","  Downloading jedi-0.19.2-py2.py3-none-any.whl.metadata (22 kB)\n","Requirement already satisfied: decorator in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (4.4.2)\n","Requirement already satisfied: pickleshare in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (0.7.5)\n","Requirement already satisfied: prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0 in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (3.0.52)\n","Requirement already satisfied: pygments in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (2.19.2)\n","Requirement already satisfied: backcall in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (0.2.0)\n","Requirement already satisfied: pexpect>4.3 in /usr/local/lib/python3.12/dist-packages (from ipython>=4.0.0->ipywidgets) (4.9.0)\n","Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/lib/python3.12/dist-packages (from jinja2>=3.0.3->jupyterlab) (3.0.3)\n","Requirement already satisfied: argon2-cffi>=21.1 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (25.1.0)\n","Requirement already satisfied: jupyter-events>=0.9.0 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (0.12.0)\n","Requirement already satisfied: jupyter-server-terminals>=0.4.4 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (0.5.3)\n","Requirement already satisfied: nbconvert>=6.4.4 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (7.16.6)\n","Requirement already satisfied: nbformat>=5.3.0 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (5.10.4)\n","Requirement already satisfied: overrides>=5.0 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (7.7.0)\n","Requirement already satisfied: prometheus-client>=0.9 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (0.23.1)\n","Requirement already satisfied: send2trash>=1.8.2 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (1.8.3)\n","Requirement already satisfied: terminado>=0.8.3 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (0.18.1)\n","Requirement already satisfied: websocket-client>=1.7 in /usr/local/lib/python3.12/dist-packages (from jupyter-server<3,>=2.4.0->jupyterlab) (1.9.0)\n","Requirement already satisfied: babel>=2.10 in /usr/local/lib/python3.12/dist-packages (from jupyterlab-server<3,>=2.27.1->jupyterlab) (2.17.0)\n","Collecting json5>=0.9.0 (from jupyterlab-server<3,>=2.27.1->jupyterlab)\n","  Downloading json5-0.12.1-py3-none-any.whl.metadata (36 kB)\n","Requirement already satisfied: jsonschema>=4.18.0 in /usr/local/lib/python3.12/dist-packages (from jupyterlab-server<3,>=2.27.1->jupyterlab) (4.25.1)\n","Requirement already satisfied: contourpy>=1.0.1 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (1.3.3)\n","Requirement already satisfied: cycler>=0.10 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (0.12.1)\n","Requirement already satisfied: fonttools>=4.22.0 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (4.60.1)\n","Requirement already satisfied: kiwisolver>=1.3.1 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (1.4.9)\n","Requirement already satisfied: pillow>=8 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (11.3.0)\n","Requirement already satisfied: pyparsing>=2.3.1 in /usr/local/lib/python3.12/dist-packages (from matplotlib!=3.6.1,>=3.4->seaborn) (3.2.5)\n","Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/lib/python3.12/dist-packages (from pydantic<3->wandb) (0.7.0)\n","Requirement already satisfied: pydantic-core==2.33.2 in /usr/local/lib/python3.12/dist-packages (from pydantic<3->wandb) (2.33.2)\n","Requirement already satisfied: typing-inspection>=0.4.0 in /usr/local/lib/python3.12/dist-packages (from pydantic<3->wandb) (0.4.2)\n","Requirement already satisfied: six>=1.5 in /usr/local/lib/python3.12/dist-packages (from python-dateutil>=2.8.2->pandas) (1.17.0)\n","Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.0.0->wandb) (3.4.4)\n","Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/lib/python3.12/dist-packages (from requests<3,>=2.0.0->wandb) (2.5.0)\n","Requirement already satisfied: notebook>=4.4.1 in /usr/local/lib/python3.12/dist-packages (from widgetsnbextension~=3.6.0->ipywidgets) (6.5.7)\n","Requirement already satisfied: filelock in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (3.20.0)\n","Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (2025.3.0)\n","Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/lib/python3.12/dist-packages (from huggingface_hub->timm) (1.2.0)\n","Requirement already satisfied: sympy>=1.13.3 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (1.13.3)\n","Requirement already satisfied: networkx in /usr/local/lib/python3.12/dist-packages (from torch->timm) (3.5)\n","Requirement already satisfied: nvidia-cuda-nvrtc-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\n","Requirement already satisfied: nvidia-cuda-runtime-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\n","Requirement already satisfied: nvidia-cuda-cupti-cu12==12.6.80 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.80)\n","Requirement already satisfied: nvidia-cudnn-cu12==9.10.2.21 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (9.10.2.21)\n","Requirement already satisfied: nvidia-cublas-cu12==12.6.4.1 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.4.1)\n","Requirement already satisfied: nvidia-cufft-cu12==11.3.0.4 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (11.3.0.4)\n","Requirement already satisfied: nvidia-curand-cu12==10.3.7.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (10.3.7.77)\n","Requirement already satisfied: nvidia-cusolver-cu12==11.7.1.2 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (11.7.1.2)\n","Requirement already satisfied: nvidia-cusparse-cu12==12.5.4.2 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.5.4.2)\n","Requirement already satisfied: nvidia-cusparselt-cu12==0.7.1 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (0.7.1)\n","Requirement already satisfied: nvidia-nccl-cu12==2.27.3 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (2.27.3)\n","Requirement already satisfied: nvidia-nvtx-cu12==12.6.77 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.77)\n","Requirement already satisfied: nvidia-nvjitlink-cu12==12.6.85 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (12.6.85)\n","Requirement already satisfied: nvidia-cufile-cu12==1.11.1.6 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (1.11.1.6)\n","Requirement already satisfied: triton==3.4.0 in /usr/local/lib/python3.12/dist-packages (from torch->timm) (3.4.0)\n","Requirement already satisfied: sniffio>=1.1 in /usr/local/lib/python3.12/dist-packages (from anyio->httpx<1,>=0.25.0->jupyterlab) (1.3.1)\n","Requirement already satisfied: argon2-cffi-bindings in /usr/local/lib/python3.12/dist-packages (from argon2-cffi>=21.1->jupyter-server<3,>=2.4.0->jupyterlab) (25.1.0)\n","Requirement already satisfied: smmap<6,>=3.0.1 in /usr/local/lib/python3.12/dist-packages (from gitdb<5,>=4.0.1->gitpython!=3.1.29,>=1.0.0->wandb) (5.0.2)\n","Requirement already satisfied: parso<0.9.0,>=0.8.4 in /usr/local/lib/python3.12/dist-packages (from jedi>=0.16->ipython>=4.0.0->ipywidgets) (0.8.5)\n","Requirement already satisfied: attrs>=22.2.0 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=4.18.0->jupyterlab-server<3,>=2.27.1->jupyterlab) (25.4.0)\n","Requirement already satisfied: jsonschema-specifications>=2023.03.6 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=4.18.0->jupyterlab-server<3,>=2.27.1->jupyterlab) (2025.9.1)\n","Requirement already satisfied: referencing>=0.28.4 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=4.18.0->jupyterlab-server<3,>=2.27.1->jupyterlab) (0.37.0)\n","Requirement already satisfied: rpds-py>=0.7.1 in /usr/local/lib/python3.12/dist-packages (from jsonschema>=4.18.0->jupyterlab-server<3,>=2.27.1->jupyterlab) (0.28.0)\n","Requirement already satisfied: entrypoints in /usr/local/lib/python3.12/dist-packages (from jupyter-client>=6.1.12->ipykernel!=6.30.0,>=6.5.0->jupyterlab) (0.4)\n","Requirement already satisfied: python-json-logger>=2.0.4 in /usr/local/lib/python3.12/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (4.0.0)\n","Requirement already satisfied: rfc3339-validator in /usr/local/lib/python3.12/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (0.1.4)\n","Requirement already satisfied: rfc3986-validator>=0.1.1 in /usr/local/lib/python3.12/dist-packages (from jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (0.1.1)\n","Requirement already satisfied: beautifulsoup4 in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (4.13.5)\n","Requirement already satisfied: bleach!=5.0.0 in /usr/local/lib/python3.12/dist-packages (from bleach[css]!=5.0.0->nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (6.3.0)\n","Requirement already satisfied: defusedxml in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (0.7.1)\n","Requirement already satisfied: jupyterlab-pygments in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (0.3.0)\n","Requirement already satisfied: mistune<4,>=2.0.3 in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (3.1.4)\n","Requirement already satisfied: nbclient>=0.5.0 in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (0.10.2)\n","Requirement already satisfied: pandocfilters>=1.4.1 in /usr/local/lib/python3.12/dist-packages (from nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (1.5.1)\n","Requirement already satisfied: fastjsonschema>=2.15 in /usr/local/lib/python3.12/dist-packages (from nbformat>=5.3.0->jupyter-server<3,>=2.4.0->jupyterlab) (2.21.2)\n","Requirement already satisfied: nbclassic>=0.4.7 in /usr/local/lib/python3.12/dist-packages (from notebook>=4.4.1->widgetsnbextension~=3.6.0->ipywidgets) (1.3.3)\n","Requirement already satisfied: ptyprocess>=0.5 in /usr/local/lib/python3.12/dist-packages (from pexpect>4.3->ipython>=4.0.0->ipywidgets) (0.7.0)\n","Requirement already satisfied: wcwidth in /usr/local/lib/python3.12/dist-packages (from prompt-toolkit!=3.0.0,!=3.0.1,<3.1.0,>=2.0.0->ipython>=4.0.0->ipywidgets) (0.2.14)\n","Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from sympy>=1.13.3->torch->timm) (1.3.0)\n","Requirement already satisfied: webencodings in /usr/local/lib/python3.12/dist-packages (from bleach!=5.0.0->bleach[css]!=5.0.0->nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (0.5.1)\n","Requirement already satisfied: tinycss2<1.5,>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from bleach[css]!=5.0.0->nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (1.4.0)\n","Requirement already satisfied: fqdn in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (1.5.1)\n","Requirement already satisfied: isoduration in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (20.11.0)\n","Requirement already satisfied: jsonpointer>1.13 in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (3.0.0)\n","Requirement already satisfied: rfc3987-syntax>=1.1.0 in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (1.1.0)\n","Requirement already satisfied: uri-template in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (1.3.0)\n","Requirement already satisfied: webcolors>=24.6.0 in /usr/local/lib/python3.12/dist-packages (from jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (25.10.0)\n","Requirement already satisfied: cffi>=1.0.1 in /usr/local/lib/python3.12/dist-packages (from argon2-cffi-bindings->argon2-cffi>=21.1->jupyter-server<3,>=2.4.0->jupyterlab) (2.0.0)\n","Requirement already satisfied: soupsieve>1.2 in /usr/local/lib/python3.12/dist-packages (from beautifulsoup4->nbconvert>=6.4.4->jupyter-server<3,>=2.4.0->jupyterlab) (2.8)\n","Requirement already satisfied: pycparser in /usr/local/lib/python3.12/dist-packages (from cffi>=1.0.1->argon2-cffi-bindings->argon2-cffi>=21.1->jupyter-server<3,>=2.4.0->jupyterlab) (2.23)\n","Requirement already satisfied: lark>=1.2.2 in /usr/local/lib/python3.12/dist-packages (from rfc3987-syntax>=1.1.0->jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (1.3.1)\n","Requirement already satisfied: arrow>=0.15.0 in /usr/local/lib/python3.12/dist-packages (from isoduration->jsonschema[format-nongpl]>=4.18.0->jupyter-events>=0.9.0->jupyter-server<3,>=2.4.0->jupyterlab) (1.4.0)\n","Downloading jupyterlab-4.4.10-py3-none-any.whl (12.3 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m12.3/12.3 MB\u001b[0m \u001b[31m111.1 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading fire-0.7.1-py3-none-any.whl (115 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m115.9/115.9 kB\u001b[0m \u001b[31m11.4 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading palettable-3.3.3-py2.py3-none-any.whl (332 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m332.3/332.3 kB\u001b[0m \u001b[31m31.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading async_lru-2.0.5-py3-none-any.whl (6.1 kB)\n","Downloading jupyter_lsp-2.3.0-py3-none-any.whl (76 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m76.7/76.7 kB\u001b[0m \u001b[31m8.3 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading jupyterlab_server-2.28.0-py3-none-any.whl (59 kB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m59.8/59.8 kB\u001b[0m \u001b[31m5.9 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading jedi-0.19.2-py2.py3-none-any.whl (1.6 MB)\n","\u001b[2K   \u001b[90m━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━\u001b[0m \u001b[32m1.6/1.6 MB\u001b[0m \u001b[31m79.5 MB/s\u001b[0m eta \u001b[36m0:00:00\u001b[0m\n","\u001b[?25hDownloading json5-0.12.1-py3-none-any.whl (36 kB)\n","Installing collected packages: palettable, json5, jedi, fire, async-lru, jupyterlab-server, jupyter-lsp, jupyterlab\n","Successfully installed async-lru-2.0.5 fire-0.7.1 jedi-0.19.2 json5-0.12.1 jupyter-lsp-2.3.0 jupyterlab-4.4.10 jupyterlab-server-2.28.0 palettable-3.3.3\n"]}],"source":["!pip install dill jupyterlab ipywidgets tqdm fire seaborn palettable wandb numpy scipy pandas scikit-learn timm"]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"executionInfo":{"elapsed":5224,"status":"ok","timestamp":1763288400429,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"},"user_tz":-210},"id":"hKxo7yfvUuk3","outputId":"f4f5d3eb-b503-4bc5-b32f-a70b77e47054","collapsed":true},"outputs":[{"output_type":"stream","name":"stdout","text":["/content/drive/MyDrive/NTK-Projection/tight-pac-bayes\n","Obtaining file:///content/drive/MyDrive/NTK-Projection/tight-pac-bayes\n","  \u001b[1;31merror\u001b[0m: \u001b[1msubprocess-exited-with-error\u001b[0m\n","  \n","  \u001b[31m×\u001b[0m \u001b[32mpython setup.py egg_info\u001b[0m did not run successfully.\n","  \u001b[31m│\u001b[0m exit code: \u001b[1;36m1\u001b[0m\n","  \u001b[31m╰─>\u001b[0m See above for output.\n","  \n","  \u001b[1;35mnote\u001b[0m: This error originates from a subprocess, and is likely not a problem with pip.\n","  Preparing metadata (setup.py) ... \u001b[?25l\u001b[?25herror\n","\u001b[1;31merror\u001b[0m: \u001b[1mmetadata-generation-failed\u001b[0m\n","\n","\u001b[31m×\u001b[0m Encountered error while generating package metadata.\n","\u001b[31m╰─>\u001b[0m See above for output.\n","\n","\u001b[1;35mnote\u001b[0m: This is an issue with the package mentioned above, not pip.\n","\u001b[1;36mhint\u001b[0m: See above for details.\n"]}],"source":["%cd /content/drive/MyDrive/NTK-Projection/tight-pac-bayes\n","!pip install -e ."]},{"cell_type":"code","execution_count":null,"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"1zunyd9kQi9J","outputId":"01843413-e176-4c4d-934b-8b128cccffbd","collapsed":true},"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.22.3\n","\u001b[34m\u001b[1mwandb\u001b[0m: W&B syncing is set to \u001b[1m`offline`\u001b[0m in this directory. Run \u001b[1m`wandb online`\u001b[0m or set \u001b[1mWANDB_MODE=online\u001b[0m to enable cloud syncing.\n","\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/content/drive/MyDrive/NTK-Projection/tight-pac-bayes/wandb/offline-run-20251116_103708-12384869\u001b[0m\n","[2025-11-16 10:38:22,257] (set_logging:INFO) Files stored in \"/content/drive/MyDrive/NTK-Projection/tight-pac-bayes/wandb/offline-run-20251116_103708-12384869/files\".\n","[2025-11-16 10:38:22,258] (entrypoint:INFO) Working with 1 process(es).\n","100% 170M/170M [00:03<00:00, 43.0MB/s]\n","loaded data successfully\n","15000 3000\n","3 6\n"," 13% 13/100 [10:08<1:08:09, 47.00s/it]"]}],"source":["!python experiments/test.py --dataset=CIFAR10 \\\n","                            --model-name=CNTK \\\n","                            --base-width=8 \\\n","                            --optimizer=adam \\\n","                            --epochs=100 \\\n","                            --lr=1e-2 \\\n","                            --seed=137 \\\n","                            --n_train_tasks=1 \\\n","                            --n_test_tasks=1"]},{"cell_type":"code","source":["!python experiments/train.py --dataset=cifar10 \\\n","                            --model-name=Layer13s \\\n","                            --base-width=8 \\\n","                            --optimizer=adam \\\n","                            --epochs=100 \\\n","                            --lr=1e-3 \\\n","                            --intrinsic_dim=3500 \\\n","                            --intrinsic_mode=filmrdkron \\\n","                            --seed=137 \\\n","                            --is_P_trainable=True"],"metadata":{"id":"Q7DrMmUg6rbq","colab":{"base_uri":"https://localhost:8080/"},"collapsed":true,"outputId":"779cd479-6eaf-4611-d9de-34cc7bc82e2b"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.22.1\n","\u001b[34m\u001b[1mwandb\u001b[0m: W&B syncing is set to \u001b[1m`offline`\u001b[0m in this directory. Run \u001b[1m`wandb online`\u001b[0m or set \u001b[1mWANDB_MODE=online\u001b[0m to enable cloud syncing.\n","\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251007_164041-xet5qo4b\u001b[0m\n","[2025-10-07 16:40:42,166] (set_logging:INFO) Files stored in \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251007_164041-xet5qo4b/files\".\n","[2025-10-07 16:40:42,166] (entrypoint:INFO) Working with 1 process(es).\n","100% 170M/170M [00:16<00:00, 10.5MB/s]\n","[2025-10-07 16:41:02,637] (get_dataset:INFO) Train Dataset Size: 50000;  Test Dataset Size: 10000\n","[2025-10-07 16:41:02,685] (create_model:INFO) Saved base model at \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251007_164041-xet5qo4b/files/init_model.pt\".\n","63738 842 3500\n","  0% 0/100 [00:00<?, ?it/s]/content/drive/MyDrive/tight-pac-bayes/pactl/nn/linear_operator_base.py:889: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4421.)\n","  elems = M@v[i:i_end].T.reshape(k*multiplicity,M.shape[-1]).T\n","[2025-10-07 16:49:30,586] (main:INFO) Epoch 0: 0.3434 (Train) / 0.3544 (Test)\n","  1% 1/100 [08:15<13:37:35, 495.51s/it][2025-10-07 16:57:44,978] (main:INFO) Epoch 1: 0.3972 (Train) / 0.4036 (Test)\n","  2% 2/100 [16:29<13:28:15, 494.85s/it][2025-10-07 17:05:59,220] (main:INFO) Epoch 2: 0.4326 (Train) / 0.4349 (Test)\n","  3% 3/100 [24:44<13:19:33, 494.57s/it][2025-10-07 17:14:11,720] (main:INFO) Epoch 3: 0.4590 (Train) / 0.4576 (Test)\n","  4% 4/100 [32:56<13:10:00, 493.76s/it][2025-10-07 17:22:20,249] (main:INFO) Epoch 4: 0.4802 (Train) / 0.4762 (Test)\n","  5% 5/100 [41:05<12:58:47, 491.87s/it][2025-10-07 17:30:27,215] (main:INFO) Epoch 5: 0.4908 (Train) / 0.4790 (Test)\n","  6% 6/100 [49:12<12:47:59, 490.20s/it][2025-10-07 17:38:35,682] (main:INFO) Epoch 6: 0.4982 (Train) / 0.4934 (Test)\n","  7% 7/100 [57:20<12:38:55, 489.63s/it][2025-10-07 17:46:44,330] (main:INFO) Epoch 7: 0.5154 (Train) / 0.5133 (Test)\n","  9% 9/100 [1:13:37<12:21:43, 489.05s/it][2025-10-07 18:03:01,756] (main:INFO) Epoch 9: 0.5309 (Train) / 0.5262 (Test)\n"," 11% 11/100 [1:29:54<12:05:02, 488.79s/it][2025-10-07 18:19:20,029] (main:INFO) Epoch 11: 0.5465 (Train) / 0.5308 (Test)\n"," 12% 12/100 [1:38:04<11:57:26, 489.17s/it][2025-10-07 18:27:25,657] (main:INFO) Epoch 12: 0.5509 (Train) / 0.5387 (Test)\n"," 13% 13/100 [1:46:10<11:47:43, 488.09s/it][2025-10-07 18:35:31,350] (main:INFO) Epoch 13: 0.5590 (Train) / 0.5471 (Test)\n"," 14% 14/100 [1:54:16<11:38:33, 487.37s/it][2025-10-07 18:43:42,121] (main:INFO) Epoch 14: 0.5644 (Train) / 0.5518 (Test)\n"," 15% 15/100 [2:02:27<11:31:53, 488.39s/it]"]}]},{"cell_type":"code","source":["!python experiments/train.py --dataset=cifar10 \\\n","                            --model-name=Layer13s \\\n","                            --base-width=8 \\\n","                            --optimizer=adam \\\n","                            --epochs=40 \\\n","                            --lr=1e-3 \\\n","                            --intrinsic_dim=500 \\\n","                            --intrinsic_mode=filmrdkron \\\n","                            --seed=137 \\\n","                            --is_P_trainable=False"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"HDF7jsvuNjHH","executionInfo":{"status":"ok","timestamp":1760423286736,"user_tz":-210,"elapsed":913460,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"}},"outputId":"38247301-6d5c-41f1-8f7f-4bbc84c05170","collapsed":true},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.22.2\n","\u001b[34m\u001b[1mwandb\u001b[0m: W&B syncing is set to \u001b[1m`offline`\u001b[0m in this directory. Run \u001b[1m`wandb online`\u001b[0m or set \u001b[1mWANDB_MODE=online\u001b[0m to enable cloud syncing.\n","\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_055757-5deury7r\u001b[0m\n","[2025-10-14 05:57:58,376] (set_logging:INFO) Files stored in \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_055757-5deury7r/files\".\n","[2025-10-14 05:57:58,376] (entrypoint:INFO) Working with 1 process(es).\n","[2025-10-14 05:57:59,972] (get_dataset:INFO) Train Dataset Size: 50000;  Test Dataset Size: 10000\n","[2025-10-14 05:58:00,001] (create_model:INFO) Saved base model at \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_055757-5deury7r/files/init_model.pt\".\n","63738 842 500\n","  0% 0/40 [00:00<?, ?it/s]/content/drive/MyDrive/tight-pac-bayes/pactl/nn/linear_operator_base.py:889: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4421.)\n","  elems = M@v[i:i_end].T.reshape(k*multiplicity,M.shape[-1]).T\n","[2025-10-14 05:58:48,592] (main:INFO) Epoch 0: 0.2335 (Train) / 0.2379 (Test)\n","  2% 1/40 [00:48<31:35, 48.60s/it][2025-10-14 05:59:33,354] (main:INFO) Epoch 1: 0.2681 (Train) / 0.2772 (Test)\n","  5% 2/40 [01:33<29:20, 46.34s/it][2025-10-14 06:00:17,987] (main:INFO) Epoch 2: 0.2897 (Train) / 0.3002 (Test)\n","  8% 3/40 [02:17<28:05, 45.56s/it][2025-10-14 06:01:02,516] (main:INFO) Epoch 3: 0.3023 (Train) / 0.3213 (Test)\n"," 10% 4/40 [03:02<27:05, 45.15s/it][2025-10-14 06:01:46,585] (main:INFO) Epoch 4: 0.3134 (Train) / 0.3314 (Test)\n"," 12% 5/40 [03:46<26:06, 44.76s/it][2025-10-14 06:02:32,286] (main:INFO) Epoch 5: 0.3251 (Train) / 0.3349 (Test)\n"," 15% 6/40 [04:32<25:32, 45.08s/it][2025-10-14 06:03:16,178] (main:INFO) Epoch 6: 0.3336 (Train) / 0.3474 (Test)\n"," 18% 7/40 [05:16<24:34, 44.70s/it][2025-10-14 06:04:00,327] (main:INFO) Epoch 7: 0.3354 (Train) / 0.3490 (Test)\n"," 20% 8/40 [06:00<23:44, 44.52s/it][2025-10-14 06:04:44,413] (main:INFO) Epoch 8: 0.3457 (Train) / 0.3585 (Test)\n"," 22% 9/40 [06:44<22:55, 44.38s/it][2025-10-14 06:05:29,058] (main:INFO) Epoch 9: 0.3488 (Train) / 0.3606 (Test)\n"," 25% 10/40 [07:29<22:13, 44.46s/it][2025-10-14 06:06:14,549] (main:INFO) Epoch 10: 0.3545 (Train) / 0.3624 (Test)\n"," 28% 11/40 [08:14<21:38, 44.78s/it][2025-10-14 06:06:58,941] (main:INFO) Epoch 11: 0.3566 (Train) / 0.3670 (Test)\n"," 30% 12/40 [08:58<20:50, 44.66s/it][2025-10-14 06:07:43,100] (main:INFO) Epoch 12: 0.3605 (Train) / 0.3678 (Test)\n"," 32% 13/40 [09:43<20:01, 44.51s/it][2025-10-14 06:08:26,852] (main:INFO) Epoch 13: 0.3676 (Train) / 0.3719 (Test)\n"," 35% 14/40 [10:26<19:11, 44.28s/it][2025-10-14 06:09:12,786] (main:INFO) Epoch 14: 0.3672 (Train) / 0.3771 (Test)\n"," 42% 17/40 [12:43<17:15, 45.03s/it][2025-10-14 06:11:27,295] (main:INFO) Epoch 17: 0.3756 (Train) / 0.3784 (Test)\n"," 45% 18/40 [13:27<16:25, 44.78s/it][2025-10-14 06:12:11,131] (main:INFO) Epoch 18: 0.3754 (Train) / 0.3812 (Test)\n"," 50% 20/40 [14:54<14:45, 44.29s/it][2025-10-14 06:13:38,758] (main:INFO) Epoch 20: 0.3821 (Train) / 0.3816 (Test)\n"," 52% 21/40 [15:38<13:58, 44.15s/it][2025-10-14 06:14:22,529] (main:INFO) Epoch 21: 0.3822 (Train) / 0.3841 (Test)\n"," 57% 23/40 [17:08<12:36, 44.51s/it][2025-10-14 06:15:52,981] (main:INFO) Epoch 23: 0.3849 (Train) / 0.3861 (Test)\n"," 60% 24/40 [17:52<11:53, 44.61s/it][2025-10-14 06:16:41,658] (main:INFO) Epoch 24: 0.3861 (Train) / 0.3875 (Test)\n"," 62% 25/40 [18:41<11:27, 45.83s/it][2025-10-14 06:17:27,572] (main:INFO) Epoch 25: 0.3857 (Train) / 0.3901 (Test)\n"," 68% 27/40 [20:13<09:55, 45.79s/it][2025-10-14 06:18:58,502] (main:INFO) Epoch 27: 0.3935 (Train) / 0.3933 (Test)\n"," 70% 28/40 [20:58<09:07, 45.64s/it][2025-10-14 06:19:44,696] (main:INFO) Epoch 28: 0.3954 (Train) / 0.3945 (Test)\n"," 78% 31/40 [23:17<06:55, 46.14s/it][2025-10-14 06:22:03,222] (main:INFO) Epoch 31: 0.3985 (Train) / 0.3989 (Test)\n"," 80% 32/40 [24:03<06:07, 45.93s/it][2025-10-14 06:22:47,279] (main:INFO) Epoch 32: 0.3989 (Train) / 0.3998 (Test)\n"," 82% 33/40 [24:47<05:17, 45.37s/it][2025-10-14 06:23:32,367] (main:INFO) Epoch 33: 0.4009 (Train) / 0.4013 (Test)\n"," 85% 34/40 [25:32<04:31, 45.28s/it][2025-10-14 06:24:17,538] (main:INFO) Epoch 34: 0.3981 (Train) / 0.4050 (Test)\n"," 88% 35/40 [26:17<03:46, 45.25s/it][2025-10-14 06:25:03,186] (main:INFO) Epoch 35: 0.4027 (Train) / 0.4060 (Test)\n"," 90% 36/40 [27:03<03:01, 45.37s/it][2025-10-14 06:25:48,134] (main:INFO) Epoch 36: 0.4058 (Train) / 0.4067 (Test)\n"," 92% 37/40 [27:48<02:15, 45.24s/it][2025-10-14 06:26:33,223] (main:INFO) Epoch 37: 0.4066 (Train) / 0.4102 (Test)\n"," 95% 38/40 [28:33<01:30, 45.20s/it][2025-10-14 06:27:19,752] (main:INFO) Epoch 38: 0.4071 (Train) / 0.4103 (Test)\n"," 98% 39/40 [29:19<00:45, 45.60s/it][2025-10-14 06:28:06,662] (main:INFO) Epoch 39: 0.4094 (Train) / 0.4121 (Test)\n","100% 40/40 [30:06<00:00, 45.17s/it]\n","\u001b[34m\u001b[1mwandb\u001b[0m: \n","\u001b[34m\u001b[1mwandb\u001b[0m: Run history:\n","\u001b[34m\u001b[1mwandb\u001b[0m:        sgd/test/acc ▁▃▄▄▅▅▅▅▆▆▆▆▆▆▇▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇▇████████\n","\u001b[34m\u001b[1mwandb\u001b[0m:    sgd/test/avg_nll █▆▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁\n","\u001b[34m\u001b[1mwandb\u001b[0m:        sgd/test/nll █▆▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁\n","\u001b[34m\u001b[1mwandb\u001b[0m:       sgd/train/acc ▁▂▃▄▄▅▅▅▅▆▆▆▆▆▆▆▆▇▇▇▇▇▇▇▇▇▇▇▇▇▇█████████\n","\u001b[34m\u001b[1mwandb\u001b[0m:   sgd/train/avg_nll █▆▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁\n","\u001b[34m\u001b[1mwandb\u001b[0m:     sgd/train/epoch ▁▁▁▁▂▂▂▂▃▃▃▃▃▃▄▄▄▄▄▄▅▅▅▅▅▆▆▆▆▆▆▇▇▇▇▇▇▇▇█\n","\u001b[34m\u001b[1mwandb\u001b[0m: sgd/train/mini_loss ██▆▆▄▄▃▃▃▄▂▄▄▄▂▃▂▃▃▃▄▂▄▃▃▃▂▃▂▂▄▃▂▁▃▁▁▂▃▂\n","\u001b[34m\u001b[1mwandb\u001b[0m:       sgd/train/nll █▆▄▄▄▃▃▃▃▃▃▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▂▁▁▁▁▁▁▁▁▁▁▁▁▁\n","\u001b[34m\u001b[1mwandb\u001b[0m: \n","\u001b[34m\u001b[1mwandb\u001b[0m: Run summary:\n","\u001b[34m\u001b[1mwandb\u001b[0m:        sgd/test/acc 0.4121\n","\u001b[34m\u001b[1mwandb\u001b[0m:    sgd/test/avg_nll 1.56813\n","\u001b[34m\u001b[1mwandb\u001b[0m:   sgd/test/best_acc 0.4121\n","\u001b[34m\u001b[1mwandb\u001b[0m: sgd/test/best_epoch 39\n","\u001b[34m\u001b[1mwandb\u001b[0m:        sgd/test/nll 15681.31641\n","\u001b[34m\u001b[1mwandb\u001b[0m:       sgd/train/acc 0.40938\n","\u001b[34m\u001b[1mwandb\u001b[0m:   sgd/train/avg_nll 1.57213\n","\u001b[34m\u001b[1mwandb\u001b[0m:  sgd/train/best_acc 0.40938\n","\u001b[34m\u001b[1mwandb\u001b[0m:     sgd/train/epoch 39\n","\u001b[34m\u001b[1mwandb\u001b[0m: sgd/train/mini_loss 1.55278\n","\u001b[34m\u001b[1mwandb\u001b[0m:                  +1 ...\n","\u001b[34m\u001b[1mwandb\u001b[0m: \n","\u001b[34m\u001b[1mwandb\u001b[0m: You can sync this run to the cloud by running:\n","\u001b[34m\u001b[1mwandb\u001b[0m: \u001b[1mwandb sync /content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_055757-5deury7r\u001b[0m\n","\u001b[34m\u001b[1mwandb\u001b[0m: Find logs at: \u001b[35m\u001b[1m./wandb/offline-run-20251014_055757-5deury7r/logs\u001b[0m\n"]}]},{"cell_type":"code","source":["!python experiments/train.py --dataset=cifar10 \\\n","                            --model-name=Layer13s \\\n","                            --base-width=8 \\\n","                            --optimizer=adam \\\n","                            --epochs=40 \\\n","                            --lr=1e-3 \\\n","                            --intrinsic_dim=400 \\\n","                            --intrinsic_mode=filmrdkron \\\n","                            --seed=137 \\\n","                            --is_P_trainable=True"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"kRN8KeSyNj0s","outputId":"e489a29d-457d-46dd-bb7e-c9408c8cc75d"},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["\u001b[34m\u001b[1mwandb\u001b[0m: Tracking run with wandb version 0.22.2\n","\u001b[34m\u001b[1mwandb\u001b[0m: W&B syncing is set to \u001b[1m`offline`\u001b[0m in this directory. Run \u001b[1m`wandb online`\u001b[0m or set \u001b[1mWANDB_MODE=online\u001b[0m to enable cloud syncing.\n","\u001b[34m\u001b[1mwandb\u001b[0m: Run data is saved locally in \u001b[35m\u001b[1m/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_063104-nfep7upt\u001b[0m\n","[2025-10-14 06:31:05,361] (set_logging:INFO) Files stored in \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_063104-nfep7upt/files\".\n","[2025-10-14 06:31:05,364] (entrypoint:INFO) Working with 1 process(es).\n","[2025-10-14 06:31:07,002] (get_dataset:INFO) Train Dataset Size: 50000;  Test Dataset Size: 10000\n","[2025-10-14 06:31:07,027] (create_model:INFO) Saved base model at \"/content/drive/MyDrive/tight-pac-bayes/wandb/offline-run-20251014_063104-nfep7upt/files/init_model.pt\".\n","63738 842 400\n","  0% 0/40 [00:00<?, ?it/s]/content/drive/MyDrive/tight-pac-bayes/pactl/nn/linear_operator_base.py:889: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4421.)\n","  elems = M@v[i:i_end].T.reshape(k*multiplicity,M.shape[-1]).T\n","[2025-10-14 06:38:00,298] (main:INFO) Epoch 0: 0.2111 (Train) / 0.2120 (Test)\n","  2% 1/40 [06:52<4:27:57, 412.26s/it][2025-10-14 06:44:50,604] (main:INFO) Epoch 1: 0.2524 (Train) / 0.2500 (Test)\n","  5% 2/40 [13:42<4:20:22, 411.11s/it][2025-10-14 06:51:41,240] (main:INFO) Epoch 2: 0.2685 (Train) / 0.2657 (Test)\n","  8% 3/40 [20:33<4:13:22, 410.89s/it][2025-10-14 06:58:30,550] (main:INFO) Epoch 3: 0.2877 (Train) / 0.2881 (Test)\n"," 10% 4/40 [27:22<4:06:09, 410.27s/it]"]}]},{"cell_type":"code","source":["import torch\n","import numpy as np\n","np.random.seed(137)\n","torch.random.manual_seed(137)\n","def _get_P_entry(P, r, c):\n","        \"\"\"Compute P[r, c] using LinearOperator operations.\"\"\"\n","        # Create a unit vector e_c (1 at index c, 0 elsewhere)\n","        e_c = torch.zeros(6)\n","        e_c[c] = 1.0\n","        # Compute P @ e_c, which gives the c-th column of P\n","        P_col_c = P @ e_c  # Shape: (D,)\n","        # Extract the r-th element\n","        return P_col_c[r]\n","\n","P = torch.rand(5, 6)\n","print(\"P:\",P)\n","subspace_params = torch.tensor([1., 2., 3., 4.,0.,2.])\n","print(\"subspace_params:\",subspace_params)\n","chosen_flat_indices = np.random.choice(5*6, size=8, replace=False)\n","rows, cols = np.unravel_index(chosen_flat_indices, (5, 6))\n","coords = list(zip(rows, cols))\n","print(\"coords:\",coords)\n","print(\"elements of P:\", P[rows,cols])\n","trainable_P = torch.ones(8)\n","print(\"trainable P:\", trainable_P)\n","\n","#print(_get_P_entry(P, 3, 5))\n","\n","print(\"first approach:\")\n","P_new = P.clone()\n","for i, (r, c) in enumerate(coords):\n","    P_new[r,c] = trainable_P[i]\n","print(\"new P:\",P_new)\n","flat_projected_params = P_new @ subspace_params\n","print(\"flat projected params:\",flat_projected_params)\n","\n","print(\"second approach:\")\n","\n","flat_projected_params = P @ subspace_params\n","# Adjust for trainable coordinates\n","for i, (r, c) in enumerate(coords):\n","    # Subtract original P[r, c] * subspace_params[c]\n","    P_rc = _get_P_entry(P,r, c)\n","    flat_projected_params[r] -= P_rc * subspace_params[c]\n","    # Add trainable contribution\n","    flat_projected_params[r] += trainable_P[i] * subspace_params[c]\n","print(\"flat projected params:\",flat_projected_params)\n","\n","\n","\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"CzqozbL1vBSp","executionInfo":{"status":"ok","timestamp":1759827020498,"user_tz":-210,"elapsed":130,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"}},"outputId":"05c1fcb1-fda6-41d6-dd3b-5203173df112","collapsed":true},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["P: tensor([[0.6257, 0.5734, 0.6673, 0.7462, 0.0150, 0.1462],\n","        [0.1975, 0.2175, 0.8977, 0.6652, 0.6920, 0.1413],\n","        [0.3016, 0.2022, 0.7721, 0.0385, 0.9591, 0.3416],\n","        [0.2233, 0.7894, 0.4403, 0.3258, 0.6924, 0.9807],\n","        [0.0436, 0.0793, 0.5200, 0.0691, 0.9973, 0.0805]])\n","subspace_params: tensor([1., 2., 3., 4., 0., 2.])\n","coords: [(np.int64(0), np.int64(2)), (np.int64(3), np.int64(4)), (np.int64(3), np.int64(0)), (np.int64(4), np.int64(1)), (np.int64(0), np.int64(3)), (np.int64(3), np.int64(5)), (np.int64(1), np.int64(4)), (np.int64(0), np.int64(0))]\n","elements of P: tensor([0.6673, 0.6924, 0.2233, 0.0793, 0.7462, 0.9807, 0.6920, 0.6257])\n","trainable P: tensor([1., 1., 1., 1., 1., 1., 1., 1.])\n","first approach:\n","new P: tensor([[1.0000, 0.5734, 1.0000, 1.0000, 0.0150, 0.1462],\n","        [0.1975, 0.2175, 0.8977, 0.6652, 1.0000, 0.1413],\n","        [0.3016, 0.2022, 0.7721, 0.0385, 0.9591, 0.3416],\n","        [1.0000, 0.7894, 0.4403, 0.3258, 1.0000, 1.0000],\n","        [0.0436, 1.0000, 0.5200, 0.0691, 0.9973, 0.0805]])\n","flat projected params: tensor([9.4392, 6.2689, 3.8598, 7.2030, 4.0409])\n","second approach:\n","flat projected params: tensor([9.4392, 6.2689, 3.8598, 7.2030, 4.0409])\n"]}]},{"cell_type":"code","source":["import torch\n","import numpy as np\n","import torch.nn as nn\n","from copy import deepcopy\n","import random\n","a = torch.ones(3,4)\n","b = nn.Parameter(torch.tensor([3.,4.,5.]))\n","print(a)\n","print(a[0,2].requires_grad)\n","print(b)\n","c = torch.tensor([1,2,3])\n","print(b+c)\n","a[0,0] = b[0]\n","a[1,1] = b[1]\n","a[2,2] = b[2]\n","print(a)\n","b.data = torch.tensor([7.,8.,9.])\n","print(b)\n","print(a)\n","print(a[0,2].requires_grad)\n"],"metadata":{"colab":{"base_uri":"https://localhost:8080/"},"id":"VsUA-WBuUI9R","executionInfo":{"status":"ok","timestamp":1758476510961,"user_tz":-210,"elapsed":8,"user":{"displayName":"Dorsa Ghobadi","userId":"16761131185373886810"}},"outputId":"f31e938c-6968-4dab-a285-87ca6311974d","collapsed":true},"execution_count":null,"outputs":[{"output_type":"stream","name":"stdout","text":["tensor([[1., 1., 1., 1.],\n","        [1., 1., 1., 1.],\n","        [1., 1., 1., 1.]])\n","False\n","Parameter containing:\n","tensor([3., 4., 5.], requires_grad=True)\n","tensor([4., 6., 8.], grad_fn=<AddBackward0>)\n","tensor([[3., 1., 1., 1.],\n","        [1., 4., 1., 1.],\n","        [1., 1., 5., 1.]], grad_fn=<CopySlices>)\n","Parameter containing:\n","tensor([7., 8., 9.], requires_grad=True)\n","tensor([[3., 1., 1., 1.],\n","        [1., 4., 1., 1.],\n","        [1., 1., 5., 1.]], grad_fn=<CopySlices>)\n","True\n"]}]},{"cell_type":"code","source":[],"metadata":{"id":"Njhdk01J35d5"},"execution_count":null,"outputs":[]}],"metadata":{"accelerator":"GPU","colab":{"gpuType":"T4","provenance":[{"file_id":"/v2/external/notebooks/intro.ipynb","timestamp":1754990111813}]},"kernelspec":{"display_name":"Python 3","name":"python3"}},"nbformat":4,"nbformat_minor":0}